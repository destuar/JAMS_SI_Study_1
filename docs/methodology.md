# Supplementary Methodology – Study 1 (Text‑Only Field Study)

---

## A. Hypothesis map

| ID | Hypothesis | Data source |
|----|------------|-------------|
| **H1** | *Rollback* (vs *Keep*) DEI → ↑ boycott‑rate & ↓ buy‑rate | Comment‑level Purchase‑Intent (PI) labels |
| **H2** | High ex‑ante **Perceived Brand Authenticity (PBA)** attenuates boycott effect | External survey scale |

*Mediated paths via Self‑Brand Connection are reserved for Study 2.*

---

## B. End-to-end Python pipeline (overview)

| Step | Phase | Tool / script | Output |
|------|-------|---------------|--------|
| 1    | 1     | Manual DOM scraper (JS) → `scripts/extract/comment_extractor.js` | Raw JSON (in `data/raw/`) |
| 2a   | 2a    | `scripts/extract/process_comments_json.py` | Individual CSVs (`data/raw/<...>/comments-csv/`) |
| 2b   | 2b    | `scripts/preprocess/combine_company_csv.py` | `data/derived/combined_comments.csv` |
| 2c   | 2c    | `scripts/preprocess/graph_features.py` | `data/derived/graphed_comments.csv` |
| 3    | 3a, 3b| Text cleaning (`scripts/preprocess/clean_comments.py`) & `full_text` creation (e.g., in `clean_comments.py`) | `data/derived/cleaned_threaded_comments.csv` |
| 4    | 4a, 5a| Sampling for annotation (`scripts/annotate/sample_for_relevance.py`, `scripts/annotate/sample_for_sentiment.py`) | `data/annotate/sample/relevance_sample.csv`, `data/annotate/sample/sentiment_sample.csv` |
| 5    | 4b, 5b| **Label Studio** annotation (see `data/annotate/instructions/ANNOTATION_README.md`) | `data/annotate/complete/combined_relevance_annotations.csv`, `data/annotate/complete/combined_sentiment_annotations.csv` |
| 6    | 4c    | **SetFit** fine-tuning (`scripts/model/train_relevance_model.py`) | Relevance model artifact (see training script) |
| 7    | 4d    | **SetFit** prediction (`scripts/model/apply_relevance_model.py`) | `data/derived/comments_with_relevance.csv` |
| 8    | 5c    | **GPT-4o API** via `models/sentiment_gpt4o_model/text_analytics.ipynb` (Evaluation on `combined_sentiment_annotations.csv`) | Stance & PI predictions on 1k sample (`models/sentiment_gpt4o_model/dev_1000_with_gpt_preds_full.csv`) |
| 9    | 5c    | **GPT-4o API** via `models/sentiment_gpt4o_model/text_analytics.ipynb` (Prediction on `comments_with_relevance.csv`) | `data/derived/comments_with_sentiment.csv` |

Workflow primarily managed through individual script execution.

---

## C. Classification performance (held-out test)

| Task | F1 (Macro Avg) | Accuracy | Notes |
|------|----|-------------------------|-------|
| Relevance (SetFit) | See script | See script | Performance metrics are generated by `scripts/model/train_relevance_model.py` on a held-out test set. |
| Stance (GPT-4o) | 0.9245 | 0.9630 | On 1k annotated sample (`models/sentiment_gpt4o_model/dev_1000_with_gpt4o_preds_full.csv`) |
| Purchase Intention (GPT-4o) | 0.9044 | 0.9600 | On 1k annotated sample (`models/sentiment_gpt4o_model/dev_1000_with_gpt4o_preds_full.csv`) |

---

## E. Robustness & transparency checklist

* Covariates like comment depth and reply status were included in descriptive analyses.
* Sensitivity checks, such as restricting analysis to DEI-relevant comments, were performed during model evaluation.
* The project aims for reproducibility through clearly documented scripts and data processing steps.

---

## F. File manifest (OSF repository TBD)

| File | Description |
|------|-------------|
| `data/derived/combined_comments.csv` | Combined comments from Step 2b |
| `data/derived/graphed_comments.csv` | Comments enriched with graph features (Step 2c) |
| `data/derived/cleaned_threaded_comments.csv` | Output of text cleaning/threading (Phase 3) |
| `data/derived/comments_with_relevance.csv` | Output of relevance prediction (Phase 4) |
| `data/derived/comments_with_sentiment.csv` | Output of stance/PI prediction using GPT-4o (Phase 5) |
| `data/annotate/sample/relevance_sample.csv` | Sampled comments for relevance annotation |
| `data/annotate/sample/sentiment_sample.csv` | Sampled comments for sentiment annotation |
| `data/annotate/complete/combined_relevance_annotations.csv` | Relevance annotations from Label Studio |
| `data/annotate/complete/combined_sentiment_annotations.csv` | Sentiment annotations from Label Studio (1k sample) |
| `data/annotate/instructions/ANNOTATION_README.md` | Annotation guidelines and Label Studio setup notes |
| `data/annotate/instructions/relevance_labeling_config.xml` | Label Studio config for relevance task |
| `data/annotate/instructions/sentiment_labeling_config.xml` | Label Studio config for sentiment task |
| `scripts/extract/comment_extractor.js` | Data collection script (Phase 1) |
| `scripts/extract/process_comments_json.py` | JSON parsing script (Step 2a) |
| `scripts/preprocess/combine_company_csv.py` | CSV combining script (Step 2b) |
| `scripts/preprocess/graph_features.py` | Graph feature calculation script (Step 2c) |
| `scripts/preprocess/clean_comments.py` | Text cleaning script (Phase 3a includes `full_text` creation) |
| `scripts/annotate/sample_for_relevance.py` | Script to sample data for relevance annotation (Step 4a) |
| `scripts/annotate/sample_for_sentiment.py` | Script to sample data for sentiment annotation (Step 5a) |
| `scripts/model/train_relevance_model.py` | Relevance model training script (Phase 4c - SetFit) |
| `scripts/model/apply_relevance_model.py` | Relevance model application script (Phase 4d - SetFit) |
| `models/sentiment_gpt4o_model/text_analytics.ipynb` | Jupyter notebook for GPT-4o Stance/PI evaluation and prediction |
| `models/sentiment_gpt4o_model/dev_1000_with_gpt4o_preds_full.csv` | GPT-4o predictions on 1k annotated sample |
| `scripts/visualize/` | Directory containing visualization scripts |
| `docs/ethics.md` | Full compliance checklist |
| `docs/data_statement.md` | Dataset overview & details |
| `docs/methodology.md` | This document |
| `results/tables/` | Output tables from analysis |
| `results/figures/` | Output figures from analysis |
| `results/visualizations/` | Output visualizations |

---

**Contact:** Diego Estuar — diego.estuar@cgu.edu — 18 Apr 2025

